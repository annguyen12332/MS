<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Lớp học của tôi - Giảng viên</title>
</head>
<body>
<th:block th:replace="~{teacher/layout :: layout(
    ~{::title},
    ~{::main},
    ~{::head-extra},
    ~{::scripts-extra}
)}">
    <th:block th:fragment="head-extra"></th:block>

    <main>
        <div class="container-fluid">
            <!-- Page Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h4 class="fw-bold mb-1">
                                <i class="fas fa-chalkboard me-2 text-primary"></i>Lớp học của tôi
                            </h4>
                            <p class="text-muted mb-0">Quản lý các lớp học bạn đang giảng dạy</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filter Tabs -->
            <div class="row mb-4">
                <div class="col-12">
                    <ul class="nav nav-pills">
                        <li class="nav-item">
                            <a class="nav-link" th:classappend="${status == null or status == 'ALL'} ? 'active' : ''"
                               th:href="@{/teacher/classes}">
                                <i class="fas fa-th-large me-1"></i>Tất cả
                                <span class="badge bg-light text-dark ms-1" th:text="${totalCount}">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:classappend="${status == 'ONGOING'} ? 'active' : ''"
                               th:href="@{/teacher/classes(status=ONGOING)}">
                                <i class="fas fa-play-circle me-1"></i>Đang diễn ra
                                <span class="badge bg-light text-dark ms-1" th:text="${ongoingCount}">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:classappend="${status == 'PENDING'} ? 'active' : ''"
                               th:href="@{/teacher/classes(status=PENDING)}">
                                <i class="fas fa-clock me-1"></i>Chờ bắt đầu
                                <span class="badge bg-light text-dark ms-1" th:text="${pendingCount}">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:classappend="${status == 'COMPLETED'} ? 'active' : ''"
                               th:href="@{/teacher/classes(status=COMPLETED)}">
                                <i class="fas fa-check-circle me-1"></i>Đã kết thúc
                                <span class="badge bg-light text-dark ms-1" th:text="${completedCount}">0</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Classes List -->
            <div class="row">
                <div th:if="${#lists.isEmpty(classes)}" class="col-12">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body text-center py-5">
                            <i class="fas fa-book-open fa-4x text-muted opacity-50 mb-3"></i>
                            <h5 class="text-muted">Không tìm thấy lớp học nào</h5>
                            <p class="text-muted">Bạn chưa được phân công giảng dạy lớp học nào</p>
                        </div>
                    </div>
                </div>

                <div th:unless="${#lists.isEmpty(classes)}" class="col-12">
                    <div class="row g-4">
                        <div th:each="classItem : ${classes}" class="col-lg-6">
                            <div class="card border-0 shadow-sm h-100 hover-card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div class="flex-grow-1">
                                            <h5 class="mb-2">
                                                <a th:href="@{/teacher/classes/{id}(id=${classItem.id})}"
                                                   class="text-decoration-none text-dark fw-bold"
                                                   th:text="${classItem.className}">
                                                    Tên lớp
                                                </a>
                                            </h5>
                                            <p class="text-muted mb-2" th:text="${classItem.course.name}">Tên khóa học</p>
                                            <span class="badge"
                                                  th:classappend="${classItem.status.name() == 'ONGOING' ? 'bg-success' : (classItem.status.name() == 'PENDING' ? 'bg-warning' : (classItem.status.name() == 'COMPLETED' ? 'bg-secondary' : 'bg-danger'))}"
                                                  th:text="${classItem.status.name() == 'ONGOING' ? 'Đang diễn ra' : (classItem.status.name() == 'PENDING' ? 'Chờ bắt đầu' : (classItem.status.name() == 'COMPLETED' ? 'Đã kết thúc' : 'Đã hủy'))}">
                                                Trạng thái
                                            </span>
                                        </div>
                                    </div>

                                    <div class="row g-3 mb-3">
                                        <div class="col-6">
                                            <div class="d-flex align-items-center">
                                                <div class="bg-primary bg-opacity-10 text-primary rounded p-2 me-2">
                                                    <i class="fas fa-users"></i>
                                                </div>
                                                <div>
                                                    <small class="text-muted d-block">Học viên</small>
                                                    <strong th:text="${classItem.currentStudents} + '/' + ${classItem.maxStudents}">0/30</strong>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="d-flex align-items-center">
                                                <div class="bg-info bg-opacity-10 text-info rounded p-2 me-2">
                                                    <i class="fas fa-clock"></i>
                                                </div>
                                                <div>
                                                    <small class="text-muted d-block">Thời lượng</small>
                                                    <strong th:text="${classItem.course.durationHours} + 'h'">40h</strong>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="d-flex align-items-center">
                                                <div class="bg-success bg-opacity-10 text-success rounded p-2 me-2">
                                                    <i class="fas fa-calendar-alt"></i>
                                                </div>
                                                <div>
                                                    <small class="text-muted d-block">Bắt đầu</small>
                                                    <strong th:text="${#temporals.format(classItem.startDate, 'dd/MM/yyyy')}">01/12/2024</strong>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="d-flex align-items-center">
                                                <div class="bg-danger bg-opacity-10 text-danger rounded p-2 me-2">
                                                    <i class="fas fa-calendar-check"></i>
                                                </div>
                                                <div>
                                                    <small class="text-muted d-block">Kết thúc</small>
                                                    <strong th:text="${#temporals.format(classItem.endDate, 'dd/MM/yyyy')}">31/01/2025</strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="d-flex gap-2">
                                        <a th:href="@{/teacher/classes/{id}(id=${classItem.id})}"
                                           class="btn btn-sm btn-outline-primary flex-fill">
                                            <i class="fas fa-eye me-1"></i>Chi tiết
                                        </a>
                                        <a th:href="@{/teacher/attendance/class/{id}/schedules(id=${classItem.id})}"
                                           class="btn btn-sm btn-outline-success flex-fill">
                                            <i class="fas fa-clipboard-check me-1"></i>Điểm danh
                                        </a>
                                        <a th:href="@{/teacher/grades/class/{id}(id=${classItem.id})}"
                                           class="btn btn-sm btn-outline-warning flex-fill">
                                            <i class="fas fa-star me-1"></i>Nhập điểm
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <th:block th:fragment="scripts-extra">
        <style>
            .hover-card {
                transition: all 0.3s ease;
            }
            .hover-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 30px rgba(0,0,0,0.15) !important;
            }
        </style>
    </th:block>
</th:block>
</body>
</html>
